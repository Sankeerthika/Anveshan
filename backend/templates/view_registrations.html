<!--<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Student Registrations</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/status_theme.css') }}">
</head>
<body>

<div class="container">
    <h1 style="color:var(--muted); text-align:center; margin-bottom:18px;">Student Registrations</h1>

    // Filter Form 
    <div class="card" style="margin-bottom: 20px; padding: 20px;">
        <h3>Filter Registrations</h3>
        <form method="GET" action="{{ url_for('events.view_registrations') }}" class="filter-form">
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                <div>
                    <label for="branch" style="display: block; margin-bottom: 5px; font-weight: 500;">Branch</label>
                    <select name="branch" id="branch" class="form-control">
                        <option value="">All Branches</option>
                        <option value="CSE" {% if request.args.get('branch') == 'CSE' %}selected{% endif %}>CSE</option>
                        <option value="IT" {% if request.args.get('branch') == 'IT' %}selected{% endif %}>IT</option>
                        <option value="ECE" {% if request.args.get('branch') == 'ECE' %}selected{% endif %}>ECE</option>
                        <option value="EEE" {% if request.args.get('branch') == 'EEE' %}selected{% endif %}>EEE</option>
                        <option value="MECH" {% if request.args.get('branch') == 'MECH' %}selected{% endif %}>MECH</option>
                        <option value="CIVIL" {% if request.args.get('branch') == 'CIVIL' %}selected{% endif %}>CIVIL</option>
                    </select>
                </div>
                <div>
                    <label for="year" style="display: block; margin-bottom: 5px; font-weight: 500;">Year</label>
                    <select name="year" id="year" class="form-control">
                        <option value="">All Years</option>
                        <option value="1" {% if request.args.get('year') == '1' %}selected{% endif %}>1st Year</option>
                        <option value="2" {% if request.args.get('year') == '2' %}selected{% endif %}>2nd Year</option>
                        <option value="3" {% if request.args.get('year') == '3' %}selected{% endif %}>3rd Year</option>
                        <option value="4" {% if request.args.get('year') == '4' %}selected{% endif %}>4th Year</option>
                    </select>
                </div>
                <div>
                    <label for="domain" style="display: block; margin-bottom: 5px; font-weight: 500;">Domain</label>
                    <select name="domain" id="domain" class="form-control">
                        <option value="">All Domains</option>
                        <option value="Web Development" {% if request.args.get('domain') == 'Web Development' %}selected{% endif %}>Web Development</option>
                        <option value="App Development" {% if request.args.get('domain') == 'App Development' %}selected{% endif %}>App Development</option>
                        <option value="AI/ML" {% if request.args.get('domain') == 'AI/ML' %}selected{% endif %}>AI/ML</option>
                        <option value="Cybersecurity" {% if request.args.get('domain') == 'Cybersecurity' %}selected{% endif %}>Cybersecurity</option>
                        <option value="IoT" {% if request.args.get('domain') == 'IoT' %}selected{% endif %}>IoT</option>
                        <option value="Blockchain" {% if request.args.get('domain') == 'Blockchain' %}selected{% endif %}>Blockchain</option>
                        <option value="Robotics" {% if request.args.get('domain') == 'Robotics' %}selected{% endif %}>Robotics</option>
                    </select>
                </div>
                <div style="display: flex; align-items: flex-end;">
                    <button type="submit" class="btn btn--primary" style="margin-right: 10px;">Apply Filters</button>
                    <a href="{{ url_for('events.view_registrations') }}" class="btn btn--secondary">Clear</a>
                </div>
            </div>
        </form>
    </div>

    <div class="card card--black-border">
    {% if registrations %}
    <div style="overflow:auto;">
    <table class="table" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr>
                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ddd;">#</th>
                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ddd;">Event</th>
                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ddd;">Team Name</th>
                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ddd;">Team Size</th>
                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ddd;">Team Lead</th>
                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ddd;">Domain</th>
                <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ddd;">Team Members</th>
            </tr>
        </thead>
        <tbody>
            {% for r in registrations %}
            <tr style="border-bottom: 1px solid #eee;">
                <td style="padding: 12px;">{{ loop.index }}</td>
                <td style="padding: 12px;">{{ r.event_title }}</td>
                <td style="padding: 12px; font-weight: 500;">{{ r.team_name }}</td>
                <td style="padding: 12px; text-align: center;">{{ r.team_size }}</td>
                <td style="padding: 12px;">
                    <strong>{{ r.team_lead_name }}</strong><br>
                    {{ r.team_lead_email }}<br>
                    <span style="color: #666;">{{ r.team_lead_branch or 'Not specified' }}</span><br>
                    Year: {{ r.team_lead_year or 'Not specified' }}
                </td>
                <td style="padding: 12px;">{{ r.domain or 'Not specified' }}</td>
                <td style="padding: 12px;">
                    {% if r.team_members and r.team_members != 'No team members' %}
                        {{ r.team_members|safe }}
                    {% else %}
                        No team members
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>

    </table>
    </div>
    {% else %}
        <p class="empty">No registrations found.</p>
    {% endif %}
    </div>

    <div style="margin-top:18px; text-align:center;">
        <a href="{{ url_for('club.club_dashboard') }}" class="btn btn--primary">â¬… Back to Dashboard</a>
    </div>

</div>

</body>
</html> -->
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Student Registrations</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .team-members {
            max-width: 300px;
            word-wrap: break-word;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }
        .form-control, .form-select {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #ced4da;
        }
        .btn-filter {
            padding: 8px 20px;
        }
    </style>
</head>
<body>
    <div class="container py-4">
        <h1 class="mb-4">Student Registrations</h1>

        <!-- Filter Form -->
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-3">Filter Registrations</h5>
                <form method="GET" class="row g-3">
                    <div class="col-md-3">
                        <label for="branch" class="form-label">Branch</label>
                        <select name="branch" id="branch" class="form-select">
                            <option value="">All Branches</option>
                            {% for branch in branches %}
                                <option value="{{ branch }}" {% if selected_branch == branch %}selected{% endif %}>
                                    {{ branch }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label for="year" class="form-label">Year</label>
                        <select name="year" id="year" class="form-select">
                            <option value="">All Years</option>
                            {% for year in years %}
                                <option value="{{ year }}" {% if selected_year == year %}selected{% endif %}>
                                    {{ year }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="domain" class="form-label">Domain</label>
                        <select name="domain" id="domain" class="form-select">
                            <option value="">All Domains</option>
                            {% for domain in domains %}
                                <option value="{{ domain }}" {% if selected_domain == domain %}selected{% endif %}>
                                    {{ domain }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="col-md-4 d-flex align-items-end">
                        <button type="submit" class="btn btn-primary me-2">Apply Filters</button>
                        <a href="{{ url_for('events.view_registrations') }}" class="btn btn-outline-secondary">Clear</a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Registrations Table -->
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Event</th>
                                <th>Team Name</th>
                                <th>Project Title</th>
                                <th>Team Lead</th>
                                <th>Branch</th>
                                <th>Year</th>
                                <th>Domain</th>
                                <th>Team Size</th>
                                <th>Status</th>
                                <th>Team Members</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for reg in registrations %}
                                <tr>
                                    <td>{{ loop.index }}</td>
                                    <td>{{ reg.event_title }}</td>
                                    <td>{{ reg.team_name }}</td>
                                    <td>{{ reg.project_title or 'N/A' }}</td>
                                    <td>
                                        {{ reg.team_lead_name }}<br>
                                        <small class="text-muted">{{ reg.team_lead_email }}</small><br>
                                        <small class="text-muted">{{ reg.team_lead_phone }}</small>
                                    </td>
                                    <td>{{ reg.team_lead_branch or 'N/A' }}</td>
                                    <td>{{ reg.team_lead_year or 'N/A' }}</td>
                                    <td>{{ reg.domain or 'N/A' }}</td>
                                    <td>{{ reg.team_size }}</td>
                                    <td>
                                        <span class="badge 
                                            {% if reg.status == 'approved' %}bg-success
                                            {% elif reg.status == 'rejected' %}bg-danger
                                            {% else %}bg-warning text-dark{% endif %}">
                                            {{ reg.status|title }}
                                        </span>
                                    </td>
                                    <td class="team-members">
                                        {% for member in reg.team_members %}
                                            <div class="mb-2">
                                                <strong>{{ member.member_name }}</strong><br>
                                                {{ member.member_email }}<br>
                                                {% if member.branch %}{{ member.branch }}{% endif %}
                                                {% if member.year %}(Year: {{ member.year }}){% endif %}
                                            </div>
                                        {% else %}
                                            No team members
                                        {% endfor %}
                                    </td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="11" class="text-center">No registrations found</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
